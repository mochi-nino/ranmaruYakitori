import{h as te,i as U,j as V,o as s,c,a as o,k as b,l as y,n as L,b as d,w as i,d as p,t as C,_ as le,r as f,m as oe,q as P,v as se,s as ae,x as F,y as N,z as T,p as ce,e as ne,g as re,E as de,F as ue}from"./entry.411f27be.js";import{_ as ie}from"./nuxt-link.a5e8a432.js";import{b as _}from"./button.66c0d799.js";const pe={class:"w-[300px] text-center"},ge=o("h2",{class:"text-2xl bg-yellow-900/90 p-3"},"後台管理",-1),xe={class:"p-5 bg-slate-100"},he={__name:"backSlider",setup(I){const B=te(),u=U([{title:"商品管理",routeName:"productMg"},{title:"會員管理",routeName:""}]),g=V(()=>k=>{if(B.name===`back-${k}`)return"bg-yellow-900 text-white"});return(k,$)=>{const m=ie;return s(),c("div",pe,[ge,o("ul",xe,[(s(!0),c(b,null,y(u,(S,x)=>(s(),c("li",{key:x,class:L(["rounded-2xl text-black hover:text-white hover:bg-yellow-700 focus:bg-yellow-800 focus:outline-",g.value(S.routeName)])},[d(m,{to:`/back/${S.routeName}`,class:"w-full block mb-5 p-2"},{default:i(()=>[p(C(S.title),1)]),_:2},1032,["to"])],2))),128))])])}}},ve=he;const j=I=>(ce("data-v-69e97313"),I=I(),ne(),I),_e={class:"flex items-center gap-24 h-[100vh] w-[90%] m-auto"},me={class:"text-xl bg-slate-100 w-full relative"},fe=j(()=>o("h1",{class:"bg-yellow-900 py-3 text-center text-3xl"},"商品管理",-1)),be={class:"absolute right-5 top-5"},ye={class:"absolute left-5 top-4"},ke={class:"grid grid-cols-[100px,250px,1fr,200px,1fr,150px] items-center justify-center text-center border-y-2 border-black p-2 mb-2"},we={class:"h-[800px] overflow-y-auto overflow-x-hidden relative",id:"scrollArea"},Ve={class:"w-[250px] m-auto relative flex flex-col items-center"},Ce=["src","alt"],je=["onClick"],Ie=j(()=>o("p",{class:"text-white font-bold"},"更換圖片",-1)),$e=[Ie],Se={key:0,src:"https://i.imgur.com/rn5Zlsq.png",alt:"404",class:"w-[250px] h-[250px] object-cover object-center border-2 border-black/30"},Ne={key:1,class:"flex justify-center gap-5 text-sm my-2"},Ue={class:"fixed w-[800px] h-[400px] top-0 bottom-0 left-[15%] right-0 m-auto z-50 bg-gray-200 border-2 border-black"},Pe=j(()=>o("h3",{class:"bg-yellow-900 text-3xl text-center py-2"},"圖片",-1)),Te=j(()=>o("p",{class:"text-center mt-10 font-bold text-red-400"}," 請輸入含有【.jpg，.jpeg，.png】的圖片網址 ",-1)),Be={class:"grid grid-cols-[100px,1fr,60px] mx-auto gap-2 mt-16"},Ee=j(()=>o("p",{class:"text-right"},"網址：",-1)),Me={class:"text-center mt-16"},Fe={class:"flex justify-center items-center flex-col"},Le=["value"],Oe={class:"flex justify-center items-center gap-2"},ze=j(()=>o("p",null,"$",-1)),De={key:0,class:"ml-auto px-2"},Je={key:1,class:"flex flex-col items-end px-2"},Ae={__name:"productMg",setup(I){const B=U(["商品編號","商品圖片","商品分類/名稱","商品價格","商品描述",""]),u=U([]),g=f(!1),k=U({data:[]}),$=f(""),m=f(!1),S=f(0),x=f(0),J=U({id:"",idx:0,newImg:[null,null,null]}),h=f(!1),A=V(()=>$.value===""?u:u.filter(t=>t.title.toLowerCase().includes($.value.toLowerCase()))),n=f(""),q=V(()=>(t,l)=>n.value===t?x.value===l:S.value===l),O=t=>{x.value=t,h.value=!h.value},G=t=>{x.value=t},z=(t,l)=>{t?(n.value="",h.value=!1,w()):(n.value=l,x.value=0)},H=V(()=>t=>n.value===t?"bg-yellow-700/30":null),R=V(()=>t=>n.value===t?"productsImg":null),Z=async()=>{u.push({id:u[u.length-1].id+1,title:"商品名",price:"價錢",description:"描述",images:[],category:{id:1,name:"類別"}}),n.value=u[u.length-1].id,g.value=!0,await ae(()=>{const t=document.getElementById("scrollArea");t.scrollTo(0,t.scrollHeight)})},D=V(()=>t=>g.value?t?"新增":"取消":t?"確定":"刪除"),K=t=>{g.value?(u.splice(u.length-1,1),g.value=!1):confirm("確定要刪除嗎？")&&fetch(`https://api.escuelajs.co/api/v1/products/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("刪除成功"),w()}).catch(l=>{console.log(l)})},Q=async t=>{await fetch(`https://api.escuelajs.co/api/v1/products/${t.id}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("修改成功"),w(),n.value="",h.value=!1}).catch(l=>{console.log(l)}),m.value=!1},W=async t=>{await fetch("https://api.escuelajs.co/api/v1/products/",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("新增成功"),w(),n.value=""}).catch(l=>{console.log(l)}),g.value=!1},X=t=>{console.log(t),g.value?W(t):Q(t)},w=()=>{fetch("https://api.escuelajs.co/api/v1/products").then(t=>t.json()).then(t=>{if(k.data.length<=0){const l=new Set(t.map(v=>JSON.stringify({id:v.category.id,name:v.category.name})));k.data=[...l].map(JSON.parse)}u.length=0,u.push(...t)}).catch(t=>{console.log(t)})};return oe(()=>{w(),console.log(u)}),(t,l)=>{const v=re,Y=de,ee=ue;return s(),c("section",_e,[d(ve),o("div",me,[fe,o("div",be,[P(o("input",{type:"text",placeholder:"搜尋商品名稱",class:"px-2 text-black","onUpdate:modelValue":l[0]||(l[0]=e=>$.value=e)},null,512),[[se,$.value]])]),o("div",ye,[d(_,{class:"!bg-slate-100 text-black !w-[80px] !h-[30px] text-lg",onClick:Z},{default:i(()=>[p("新增+")]),_:1})]),o("ul",null,[o("li",ke,[(s(!0),c(b,null,y(B,(e,E)=>(s(),c("p",{key:E},C(e),1))),128))]),o("li",we,[(s(!0),c(b,null,y(A.value,(e,E)=>(s(),c("div",{key:E},[d(ee,{onSubmit:X},{default:i(()=>[o("div",{class:L(["mb-2 grid grid-cols-[100px,250px,1fr,200px,1fr,150px] items-center justify-center text-center px-2 text-lg",H.value(e.id)])},[d(v,{type:"text",name:"id",placeholder:e.id,class:"block mb-2 px-2 py-[2px] text-center",disabled:"true",modelValue:e.id,"onUpdate:modelValue":a=>e.id=a},null,8,["placeholder","modelValue","onUpdate:modelValue"]),o("div",Ve,[(s(!0),c(b,null,y(e.images,(a,r)=>(s(),c("div",{class:L(["relative",R.value(e.id)]),key:r},[P(o("img",{src:a,alt:e.title,class:"w-[200px] h-[200px] object-cover object-center border-2 border-black/30"},null,8,Ce),[[F,q.value(e.id,r)]]),o("div",{class:"bg-gray-900/80 w-full h-full flex items-center justify-center absolute inset-0 m-auto cursor-pointer changeProductImg",onClick:M=>O(r)},$e,8,je)],2))),128)),e.images.length<3&&x.value===3&&n.value===e.id?(s(),c("img",Se)):N("",!0),n.value===e.id?(s(),c("div",Ne,[(s(!0),c(b,null,y(e.images,(a,r)=>(s(),T(_,{key:r,class:"!w-[25px] !h-[25px]",type:"button",onClick:M=>G(r)},{default:i(()=>[p(C(r+1),1)]),_:2},1032,["onClick"]))),128)),e.images.length<3&&n.value===e.id?(s(),T(_,{key:0,class:"!w-[25px] !h-[25px]",type:"button",onClick:a=>(O(e.images.length),m.value=!0)},{default:i(()=>[p("+")]),_:2},1032,["onClick"])):N("",!0)])):N("",!0)]),P(o("div",Ue,[Pe,Te,o("div",Be,[Ee,(s(!0),c(b,null,y(J.newImg,(a,r)=>P((s(),c("div",{key:r},[e.images.length>r||m.value&&e.images.length<=1||m.value&&x.value===2?(s(),T(v,{key:0,type:"url",name:`images[${r}]`,rules:{regex:/^(https?:\/\/.*\.(?:png|jpg|jpeg|))$/},label:"網址",class:"w-full h-[20px] px-2 py-4 text-black border border-gray-400/50",modelValue:e.images[r],"onUpdate:modelValue":M=>e.images[r]=M},null,8,["name","rules","modelValue","onUpdate:modelValue"])):N("",!0),d(Y,{name:`images[${r}]`,class:"text-red-500 mx-1 errors-msg"},null,8,["name"])])),[[F,x.value===r]])),128))]),o("div",Me,[d(_,{type:"button",onClick:l[1]||(l[1]=a=>(h.value=!h.value,m.value=!1))},{default:i(()=>[p("確定")]),_:1}),d(_,{type:"button",onClick:l[2]||(l[2]=a=>(h.value=!h.value,w())),class:"ml-10"},{default:i(()=>[p("取消")]),_:1})])],512),[[F,h.value&&n.value===e.id]]),o("div",Fe,[d(v,{as:"select",name:"categoryId",class:"block mb-3 px-2 py-[2px] text-black",disabled:n.value!==e.id,modelValue:e.category.id,"onUpdate:modelValue":a=>e.category.id=a},{default:i(()=>[(s(!0),c(b,null,y(k.data,(a,r)=>(s(),c("option",{key:r,value:a.id},C(a.name),9,Le))),128))]),_:2},1032,["disabled","modelValue","onUpdate:modelValue"]),d(v,{type:"text",name:"title",placeholder:e.title,class:"block px-2 py-[2px] text-center w-full",disabled:n.value!==e.id,modelValue:e.title,"onUpdate:modelValue":a=>e.title=a},null,8,["placeholder","disabled","modelValue","onUpdate:modelValue"])]),o("div",Oe,[ze,d(v,{type:"text",name:"price",placeholder:e.price,class:"px-2 py-[2px] w-[80px] text-center",disabled:n.value!==e.id,modelValue:e.price,"onUpdate:modelValue":a=>e.price=a},null,8,["placeholder","disabled","modelValue","onUpdate:modelValue"])]),o("div",null,[d(v,{as:"textarea",name:"description",placeholder:e.description,style:{resize:"none"},class:"px-2 py-[5px] text-black w-full h-[200px] overflow-y-auto",modelValue:e.description,"onUpdate:modelValue":a=>e.description=a,disabled:n.value!==e.id},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled"])]),n.value!==e.id?(s(),c("div",De,[d(_,{class:"!w-[80px] !text-lg",type:"button",onClick:a=>z(0,e.id)},{default:i(()=>[p("更改")]),_:2},1032,["onClick"])])):(s(),c("div",Je,[d(_,{class:"!w-[80px] !text-lg mb-4"},{default:i(()=>[p(C(D.value(1)),1)]),_:1}),g.value?N("",!0):(s(),T(_,{key:0,class:"!w-[80px] !text-lg",type:"button",onClick:a=>z(1,e.id)},{default:i(()=>[p("取消")]),_:2},1032,["onClick"])),d(_,{class:"!w-[80px] !text-lg mt-4",type:"button",onClick:a=>K(e.id)},{default:i(()=>[p(C(D.value(0)),1)]),_:2},1032,["onClick"])]))],2)]),_:2},1024)]))),128))])])])])}}},Re=le(Ae,[["__scopeId","data-v-69e97313"]]);export{Re as default};
