import{_ as te,h as U,r as m,i as V,j as le,c as r,b as d,a,k as $,v as ae,w as i,l as y,m as b,n as se,o,d as x,t as j,q as O,s as B,x as C,y as P,p as oe,e as ne,g as ce,E as re,F as de}from"./entry.bd2cdfd2.js";import{b as ue}from"./backSlider.9d50a6b3.js";import{b as v}from"./button.25660faf.js";import"./nuxt-link.08f5ef61.js";const k=I=>(oe("data-v-b5599f78"),I=I(),ne(),I),ie={class:"flex items-center gap-24 h-[100vh] w-[90%] m-auto"},pe={class:"text-xl bg-slate-100 w-full relative"},ge=k(()=>a("h1",{class:"bg-yellow-900 py-3 text-center text-3xl"},"商品管理",-1)),xe={class:"absolute right-5 top-5"},ve={class:"absolute left-5 top-4"},he={class:"grid grid-cols-[100px,250px,1fr,200px,1fr,150px,15px] items-center justify-center text-center border-y-2 border-black p-2 mb-2"},fe={class:"h-[800px] overflow-y-auto overflow-x-hidden relative",id:"scrollArea"},me={class:"w-[250px] m-auto relative flex flex-col items-center"},_e=["src","alt"],ye=["onClick"],be=k(()=>a("p",{class:"text-white font-bold"},"更換圖片",-1)),ke=[be],we={key:0,src:"https://i.imgur.com/rn5Zlsq.png",alt:"404",class:"w-[250px] h-[250px] object-cover object-center border-2 border-black/30"},Ve={key:1,class:"flex justify-center gap-5 text-sm my-2"},je={class:"fixed w-[800px] h-[400px] top-0 bottom-0 left-[15%] right-0 m-auto z-50 bg-gray-200 border-2 border-black"},Ce=k(()=>a("h3",{class:"bg-yellow-900 text-3xl text-center py-2"},"圖片",-1)),Ie=k(()=>a("p",{class:"text-center mt-10 font-bold text-red-400"}," 請輸入含有【.jpg，.jpeg，.png】的圖片網址 ",-1)),Se={class:"grid grid-cols-[100px,1fr,60px] mx-auto gap-2 mt-16"},Ue=k(()=>a("p",{class:"text-right"},"網址：",-1)),$e={class:"text-center mt-16"},Pe={class:"flex justify-center items-center flex-col"},Te=["value"],Ne={class:"flex justify-center items-center gap-2"},Ee=k(()=>a("p",null,"$",-1)),Be={key:0,class:"ml-auto px-2"},Me={key:1,class:"flex flex-col items-end px-2"},Fe={__name:"productMg",setup(I){const D=U(["商品編號","商品圖片","商品分類/名稱","商品價格","商品描述","",""]),u=U([]),T=U({data:[]}),S=m(""),J=m(0),h=m(0),z=U({id:"",idx:0,newImg:[null,null,null]}),f=m(!1),w=m(!1),p=m(!1),n=m(""),A=V(()=>S.value===""?u:u.filter(t=>t.title.toLowerCase().includes(S.value.toLowerCase()))),M=t=>{h.value=t,p.value=!p.value},q=t=>{h.value=t},G=V(()=>(t,l)=>n.value===t?h.value===l:J.value===l),F=(t,l)=>{t?(n.value="",p.value=!1,_()):(n.value=l,h.value=0)},H=V(()=>t=>n.value===t?"bg-yellow-700/30":null),Z=V(()=>t=>n.value===t?"productsImg":null),L=V(()=>t=>f.value?t?"新增":"取消":t?"確定":"刪除"),K=async()=>{u.push({id:u[u.length-1].id+1,title:"商品名",price:"價錢",description:"描述",images:[],category:{id:1,name:"類別"}}),n.value=u[u.length-1].id,f.value=!0,await se(()=>{const t=document.getElementById("scrollArea");t.scrollTo(0,t.scrollHeight)})},Q=async t=>{await fetch("https://api.escuelajs.co/api/v1/products/",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("新增成功"),_(),n.value=""}).catch(l=>{console.log(l)}),f.value=!1},R=async t=>{await fetch(`https://api.escuelajs.co/api/v1/products/${t.id}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("修改成功"),_(),n.value="",p.value=!1}).catch(l=>{console.log(l)}),w.value=!1},W=t=>{f.value?(u.splice(u.length-1,1),f.value=!1):confirm("確定要刪除嗎？")&&fetch(`https://api.escuelajs.co/api/v1/products/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(l=>l.json()).then(l=>{alert("刪除成功"),_()}).catch(l=>{console.log(l)})},_=()=>{fetch("https://api.escuelajs.co/api/v1/products").then(t=>t.json()).then(t=>{if(T.data.length<=0){const l=new Set(t.map(g=>JSON.stringify({id:g.category.id,name:g.category.name})));T.data=[...l].map(JSON.parse)}u.length=0,u.push(...t)}).catch(t=>{console.log(t)})},X=t=>{console.log(t),f.value?Q(t):R(t)};return le(()=>{_()}),(t,l)=>{const g=ce,Y=re,ee=de;return o(),r("section",ie,[d(ue),a("div",pe,[ge,a("div",xe,[$(a("input",{type:"text",placeholder:"搜尋商品名稱",class:"px-2 text-black","onUpdate:modelValue":l[0]||(l[0]=e=>S.value=e)},null,512),[[ae,S.value]])]),a("div",ve,[d(v,{class:"!bg-slate-100 text-black !w-[80px] !h-[30px] text-lg",onClick:K},{default:i(()=>[x("新增+")]),_:1})]),a("ul",null,[a("li",he,[(o(!0),r(y,null,b(D,(e,N)=>(o(),r("p",{key:N},j(e),1))),128))]),a("li",fe,[(o(!0),r(y,null,b(A.value,(e,N)=>(o(),r("div",{key:N},[d(ee,{onSubmit:X},{default:i(()=>[a("div",{class:O(["mb-2 grid grid-cols-[100px,250px,1fr,200px,1fr,150px] items-center justify-center text-center px-2 text-lg",H.value(e.id)])},[d(g,{type:"text",name:"id",placeholder:e.id,class:"block mb-2 px-2 py-[2px] text-center",disabled:"true",modelValue:e.id,"onUpdate:modelValue":s=>e.id=s},null,8,["placeholder","modelValue","onUpdate:modelValue"]),a("div",me,[(o(!0),r(y,null,b(e.images,(s,c)=>(o(),r("div",{class:O(["relative",Z.value(e.id)]),key:c},[$(a("img",{src:s,alt:e.title,class:"w-[200px] h-[200px] object-cover object-center border-2 border-black/30"},null,8,_e),[[B,G.value(e.id,c)]]),a("div",{class:"bg-gray-900/80 w-full h-full flex items-center justify-center absolute inset-0 m-auto cursor-pointer changeProductImg",onClick:E=>M(c)},ke,8,ye)],2))),128)),e.images.length<3&&h.value===3&&n.value===e.id?(o(),r("img",we)):C("",!0),n.value===e.id?(o(),r("div",Ve,[(o(!0),r(y,null,b(e.images,(s,c)=>(o(),P(v,{key:c,class:"!w-[25px] !h-[25px]",type:"button",onClick:E=>q(c)},{default:i(()=>[x(j(c+1),1)]),_:2},1032,["onClick"]))),128)),e.images.length<3&&n.value===e.id?(o(),P(v,{key:0,class:"!w-[25px] !h-[25px]",type:"button",onClick:s=>(M(e.images.length),w.value=!0)},{default:i(()=>[x("+")]),_:2},1032,["onClick"])):C("",!0)])):C("",!0)]),$(a("div",je,[Ce,Ie,a("div",Se,[Ue,(o(!0),r(y,null,b(z.newImg,(s,c)=>$((o(),r("div",{key:c},[e.images.length>c||w.value&&e.images.length<=1||w.value&&h.value===2?(o(),P(g,{key:0,type:"url",name:`images[${c}]`,rules:{regex:/^(https?:\/\/.*\.(?:png|jpg|jpeg|))$/},label:"網址",class:"w-full h-[20px] px-2 py-4 text-black border border-gray-400/50",modelValue:e.images[c],"onUpdate:modelValue":E=>e.images[c]=E},null,8,["name","rules","modelValue","onUpdate:modelValue"])):C("",!0),d(Y,{name:`images[${c}]`,class:"text-red-500 mx-1 errors-msg"},null,8,["name"])])),[[B,h.value===c]])),128))]),a("div",$e,[d(v,{type:"button",onClick:l[1]||(l[1]=s=>(p.value=!p.value,w.value=!1))},{default:i(()=>[x("確定")]),_:1}),d(v,{type:"button",onClick:l[2]||(l[2]=s=>(p.value=!p.value,_())),class:"ml-10"},{default:i(()=>[x("取消")]),_:1})])],512),[[B,p.value&&n.value===e.id]]),a("div",Pe,[d(g,{as:"select",name:"categoryId",class:"block mb-3 px-2 py-[2px] text-black",disabled:n.value!==e.id,modelValue:e.category.id,"onUpdate:modelValue":s=>e.category.id=s},{default:i(()=>[(o(!0),r(y,null,b(T.data,(s,c)=>(o(),r("option",{key:c,value:s.id},j(s.name),9,Te))),128))]),_:2},1032,["disabled","modelValue","onUpdate:modelValue"]),d(g,{type:"text",name:"title",placeholder:e.title,class:"block px-2 py-[2px] text-center w-full",disabled:n.value!==e.id,modelValue:e.title,"onUpdate:modelValue":s=>e.title=s},null,8,["placeholder","disabled","modelValue","onUpdate:modelValue"])]),a("div",Ne,[Ee,d(g,{type:"text",name:"price",placeholder:e.price,class:"px-2 py-[2px] w-[80px] text-center",disabled:n.value!==e.id,modelValue:e.price,"onUpdate:modelValue":s=>e.price=s},null,8,["placeholder","disabled","modelValue","onUpdate:modelValue"])]),a("div",null,[d(g,{as:"textarea",name:"description",placeholder:e.description,style:{resize:"none"},class:"px-2 py-[5px] text-black w-full h-[200px] overflow-y-auto",modelValue:e.description,"onUpdate:modelValue":s=>e.description=s,disabled:n.value!==e.id},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled"])]),n.value!==e.id?(o(),r("div",Be,[d(v,{class:"!w-[80px] !text-lg",type:"button",onClick:s=>F(0,e.id)},{default:i(()=>[x("更改")]),_:2},1032,["onClick"])])):(o(),r("div",Me,[d(v,{class:"!w-[80px] !text-lg mb-4"},{default:i(()=>[x(j(L.value(1)),1)]),_:1}),f.value?C("",!0):(o(),P(v,{key:0,class:"!w-[80px] !text-lg",type:"button",onClick:s=>F(1,e.id)},{default:i(()=>[x("取消")]),_:2},1032,["onClick"])),d(v,{class:"!w-[80px] !text-lg mt-4",type:"button",onClick:s=>W(e.id)},{default:i(()=>[x(j(L.value(0)),1)]),_:2},1032,["onClick"])]))],2)]),_:2},1024)]))),128))])])])])}}},ze=te(Fe,[["__scopeId","data-v-b5599f78"]]);export{ze as default};
